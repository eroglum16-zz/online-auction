{"ast":null,"code":"var _jsxFileName = \"/Users/mert/Desktop/I\\u0307TU\\u0308/Fall 2019/Bitirme/Project/pages/p/[id].js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Layout from '../../components/AppLayout';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { Badge } from \"reactstrap\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faUser, faMoneyBill, faCalendarAlt } from '@fortawesome/free-solid-svg-icons';\nimport { auth, getUser } from \"../../utils/auth\";\nimport { getSale } from \"../../utils/api\";\nimport Router from \"next/router\";\nimport { toTimeString } from \"../../utils/miscellaneous\";\nimport ChatBox from \"../../components/ChatBox\";\n\nconst apiConfig = require('../../api-config');\n\nconst defaults = require('../../utils/defaults');\n\nclass Purchase extends React.Component {\n  constructor(props) {\n    super(props);\n    let token = this.props.token;\n    this.state = {\n      loggedIn: !!token,\n      user: {},\n      sale: defaults.defaultSale,\n      maxBid: {\n        amount: 0,\n        bidder: {\n          email: \"\",\n          nameSurname: \"\"\n        }\n      }\n    };\n  }\n\n  componentDidMount() {\n    getUser(this.props.token).then(user => {\n      this.setState({\n        user: user\n      });\n    });\n    getSale(this.props.id).then(response => {\n      if (!response) {\n        Router.push('/purchases');\n        return;\n      }\n\n      setInterval(() => {\n        if (response.maxBid.bidder.email !== this.state.user.email) {\n          Router.push('/purchases');\n        }\n      }, 1000);\n      this.setState({\n        sale: response.sale,\n        maxBid: response.maxBid\n      });\n    });\n  }\n\n  render() {\n    const seller = this.state.sale.owner.nameSurname;\n    const salePrice = this.state.maxBid.amount;\n    return __jsx(Layout, {\n      page: \"me\",\n      user: this.state.user,\n      loggedIn: this.state.loggedIn,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: \"container bg-white\",\n      style: {\n        padding: '3%',\n        marginTop: '3%',\n        boxShadow: '0px 10px 5px 0px #ccc'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: \"col-md-1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62\n      },\n      __self: this\n    }), __jsx(\"div\", {\n      className: \"col-md-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      className: \"mb-3\",\n      style: {\n        maxHeight: '400px',\n        overflow: 'hidden'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64\n      },\n      __self: this\n    }, __jsx(\"img\", {\n      src: apiConfig.productImageBase + this.state.sale.images[0],\n      width: \"100%\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65\n      },\n      __self: this\n    })), __jsx(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    }, this.state.sale.title, __jsx(Badge, {\n      className: \"ml-3\",\n      color: \"success\",\n      pill: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69\n      },\n      __self: this\n    }, \"Ald\\u0131n\\u0131z\")), __jsx(\"hr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73\n      },\n      __self: this\n    }), __jsx(\"div\", {\n      className: \"row mt-4\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74\n      },\n      __self: this\n    }, __jsx(\"p\", {\n      className: \"col-md-6 \",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, __jsx(FontAwesomeIcon, {\n      icon: faUser,\n      width: \"16\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }), \" \", __jsx(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }, \"Sat\\u0131c\\u0131: \"), \" \", seller), __jsx(\"p\", {\n      className: \"col-md-6 \",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }, __jsx(FontAwesomeIcon, {\n      icon: faMoneyBill,\n      width: \"16\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }), \" \", __jsx(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }, \"Al\\u0131\\u015F Fiyat\\u0131: \"), \" \", salePrice, \"\\u20BA\"), __jsx(\"p\", {\n      className: \"col-md-12 mb-4\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    }, __jsx(FontAwesomeIcon, {\n      icon: faCalendarAlt,\n      width: \"16\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }), \" \", __jsx(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }, \"Kapan\\u0131\\u015F Tarihi: \"), toTimeString(this.state.sale.endDate)))), __jsx(\"div\", {\n      className: \"col-md-1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }), __jsx(\"div\", {\n      className: \"col-md-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, __jsx(ChatBox, {\n      interlocutor: seller,\n      saleId: this.state.sale._id,\n      salePrice: salePrice,\n      userToken: this.props.token,\n      userEmail: this.state.user.email,\n      receiverEmail: this.state.sale.owner.email,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    })))));\n  }\n\n}\n\nPurchase.getInitialProps = async ctx => {\n  const {\n    id\n  } = ctx.query; // Check user's session\n\n  const token = auth(ctx);\n  return {\n    id,\n    token\n  };\n};\n\nexport default Purchase;","map":{"version":3,"sources":["/Users/mert/Desktop/İTÜ/Fall 2019/Bitirme/Project/pages/p/[id].js"],"names":["Layout","Badge","FontAwesomeIcon","faUser","faMoneyBill","faCalendarAlt","auth","getUser","getSale","Router","toTimeString","ChatBox","apiConfig","require","defaults","Purchase","React","Component","constructor","props","token","state","loggedIn","user","sale","defaultSale","maxBid","amount","bidder","email","nameSurname","componentDidMount","then","setState","id","response","push","setInterval","render","seller","owner","salePrice","padding","marginTop","boxShadow","maxHeight","overflow","productImageBase","images","title","endDate","_id","getInitialProps","ctx","query"],"mappings":"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","sourcesContent":["import Layout from '../../components/AppLayout';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport {Badge} from \"reactstrap\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faUser, faMoneyBill, faCalendarAlt } from '@fortawesome/free-solid-svg-icons';\nimport {auth, getUser} from \"../../utils/auth\";\nimport {getSale} from \"../../utils/api\";\nimport Router from \"next/router\";\nimport {toTimeString} from \"../../utils/miscellaneous\";\nimport ChatBox from \"../../components/ChatBox\";\n\nconst apiConfig = require('../../api-config');\nconst defaults = require('../../utils/defaults');\n\nclass Purchase extends React.Component{\n    constructor(props) {\n        super(props);\n        let token = this.props.token;\n        this.state = {\n            loggedIn: !!token,\n            user: {},\n            sale: defaults.defaultSale,\n            maxBid: {\n                amount: 0,\n                bidder: {\n                    email: \"\",\n                    nameSurname: \"\"\n                }\n            }\n        };\n    }\n    componentDidMount() {\n        getUser(this.props.token).then(user => {\n            this.setState({\n                user: user\n            });\n        });\n        getSale(this.props.id).then(response => {\n            if (!response){\n                Router.push('/purchases');\n                return;\n            }\n            setInterval(() => {\n                if(response.maxBid.bidder.email !== this.state.user.email){\n                    Router.push('/purchases');\n                }\n            }, 1000);\n            this.setState({\n                sale: response.sale,\n                maxBid: response.maxBid\n            });\n        });\n    }\n    render() {\n        const seller = this.state.sale.owner.nameSurname;\n        const salePrice = this.state.maxBid.amount;\n        return (\n            <Layout page=\"me\" user={this.state.user} loggedIn={this.state.loggedIn}>\n                <div className=\"container bg-white\"\n                     style={{ padding:'3%', marginTop:'3%', boxShadow: '0px 10px 5px 0px #ccc'}} >\n                    <div className=\"row\">\n                        <div className=\"col-md-1\"></div>\n                        <div className=\"col-md-5\">\n                            <div className=\"mb-3\" style={{maxHeight: '400px', overflow: 'hidden'}}>\n                                <img src={apiConfig.productImageBase + this.state.sale.images[0]} width=\"100%\" />\n                            </div>\n                            <h4>\n                                {this.state.sale.title}\n                                <Badge className=\"ml-3\" color=\"success\" pill>\n                                    Aldınız\n                                </Badge>\n                            </h4>\n                            <hr/>\n                            <div className=\"row mt-4\">\n\n                                <p className=\"col-md-6 \">\n                                    <FontAwesomeIcon icon={faUser} width=\"16\" /> <b>Satıcı: </b> {seller}\n                                </p>\n                                <p className=\"col-md-6 \">\n                                    <FontAwesomeIcon icon={faMoneyBill} width=\"16\" /> <b>Alış Fiyatı: </b> {salePrice}₺\n                                </p>\n                                <p className=\"col-md-12 mb-4\">\n                                    <FontAwesomeIcon icon={faCalendarAlt} width=\"16\" /> <b>Kapanış Tarihi: </b>\n                                    {toTimeString(this.state.sale.endDate)}\n                                </p>\n                            </div>\n                        </div>\n                        <div className=\"col-md-1\"></div>\n                        <div className=\"col-md-5\">\n                            <ChatBox interlocutor={seller}\n                                     saleId={this.state.sale._id}\n                                     salePrice={salePrice}\n                                     userToken={this.props.token}\n                                     userEmail={this.state.user.email}\n                                     receiverEmail={this.state.sale.owner.email} />\n                        </div>\n                    </div>\n                </div>\n            </Layout>\n        );\n    }\n}\n\nPurchase.getInitialProps = async ctx => {\n    const {id} = ctx.query;\n\n    // Check user's session\n    const token = auth(ctx);\n\n    return { id, token }\n};\n\nexport default Purchase;"]},"metadata":{},"sourceType":"module"}