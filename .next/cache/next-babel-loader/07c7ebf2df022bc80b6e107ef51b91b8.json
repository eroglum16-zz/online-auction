{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/mert/Desktop/I\\u0307TU\\u0308/Fall 2019/Bitirme/Project/pages/s/[id].js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Layout from '../../components/AppLayout';\nimport ChatBox from \"../../components/ChatBox\";\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { Badge } from \"reactstrap\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faLiraSign, faUser, faMoneyBill, faUsers, faThumbsUp, faCalendarAlt } from '@fortawesome/free-solid-svg-icons';\nimport Link from \"next/link\";\nimport { auth, getUser } from \"../../utils/auth\";\nimport { getSale } from \"../../utils/api\";\nimport { toTimeString } from \"../../utils/miscellaneous\";\nimport Router from 'next/router';\n\nvar defaults = require('../../utils/defaults');\n\nvar apiConfig = require('../../api-config');\n\nvar Sale =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Sale, _React$Component);\n\n  function Sale(props) {\n    var _this;\n\n    _classCallCheck(this, Sale);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Sale).call(this, props));\n    var token = _this.props.token;\n    _this.state = {\n      loggedIn: !!token,\n      user: {},\n      sale: defaults.defaultSale,\n      maxBid: {\n        amount: 0,\n        bidder: {\n          email: \"\",\n          nameSurname: \"\"\n        }\n      }\n    };\n    return _this;\n  }\n\n  _createClass(Sale, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      getUser(this.props.token).then(function (user) {\n        _this2.setState({\n          user: user\n        });\n      });\n      getSale(this.props.id).then(function (response) {\n        if (!response) {\n          Router.push('/sales');\n          return;\n        }\n\n        if (response.sale.owner.email !== _this2.state.user.email) {\n          Router.push('/sales');\n        }\n\n        _this2.setState({\n          sale: response.sale,\n          maxBid: response.maxBid\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var buyer = this.state.maxBid.bidder.nameSurname;\n      var salePrice = this.state.maxBid.amount;\n      return __jsx(Layout, {\n        page: \"me\",\n        user: this.state.user,\n        loggedIn: this.state.loggedIn,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        className: \"container bg-white\",\n        style: {\n          padding: '3%',\n          marginTop: '3%',\n          boxShadow: '0px 10px 5px 0px #ccc'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 59\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        className: \"col-md-1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62\n        },\n        __self: this\n      }), __jsx(\"div\", {\n        className: \"col-md-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        className: \"mb-3\",\n        style: {\n          maxHeight: '400px',\n          overflow: 'hidden'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 64\n        },\n        __self: this\n      }, __jsx(\"img\", {\n        src: apiConfig.productImageBase + this.state.sale.images[0],\n        width: \"100%\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65\n        },\n        __self: this\n      })), __jsx(\"h4\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67\n        },\n        __self: this\n      }, this.state.sale.title, __jsx(Badge, {\n        className: \"ml-3\",\n        color: \"success\",\n        pill: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      }, \"Ald\\u0131n\\u0131z\")), __jsx(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73\n        },\n        __self: this\n      }), __jsx(\"div\", {\n        className: \"row mt-4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }, __jsx(\"p\", {\n        className: \"col-md-6 \",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76\n        },\n        __self: this\n      }, __jsx(FontAwesomeIcon, {\n        icon: faUser,\n        width: \"16\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }), \" \", __jsx(\"b\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }, \"Al\\u0131c\\u0131: \"), \" \", buyer), __jsx(\"p\", {\n        className: \"col-md-6 \",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79\n        },\n        __self: this\n      }, __jsx(FontAwesomeIcon, {\n        icon: faMoneyBill,\n        width: \"16\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80\n        },\n        __self: this\n      }), \" \", __jsx(\"b\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80\n        },\n        __self: this\n      }, \"Sat\\u0131\\u015F Fiyat\\u0131: \"), \" \", salePrice, \"\\u20BA\"), __jsx(\"p\", {\n        className: \"col-md-12 mb-4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82\n        },\n        __self: this\n      }, __jsx(FontAwesomeIcon, {\n        icon: faCalendarAlt,\n        width: \"16\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83\n        },\n        __self: this\n      }), \" \", __jsx(\"b\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83\n        },\n        __self: this\n      }, \"Kapan\\u0131\\u015F Tarihi: \"), toTimeString(this.state.sale.endDate)))), __jsx(\"div\", {\n        className: \"col-md-1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }), __jsx(\"div\", {\n        className: \"col-md-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }, __jsx(ChatBox, {\n        interlocutor: buyer,\n        saleId: this.state.sale._id,\n        salePrice: salePrice,\n        userToken: this.props.token,\n        userEmail: this.state.user.email,\n        receiverEmail: this.state.maxBid.bidder.email,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      })))));\n    }\n  }]);\n\n  return Sale;\n}(React.Component);\n\nSale.getInitialProps =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(ctx) {\n    var id, token;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            id = ctx.query.id; // Check user's session\n\n            token = auth(ctx);\n            return _context.abrupt(\"return\", {\n              id: id,\n              token: token\n            });\n\n          case 3:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nexport default Sale;","map":{"version":3,"sources":["/Users/mert/Desktop/İTÜ/Fall 2019/Bitirme/Project/pages/s/[id].js"],"names":["Layout","ChatBox","Badge","FontAwesomeIcon","faLiraSign","faUser","faMoneyBill","faUsers","faThumbsUp","faCalendarAlt","Link","auth","getUser","getSale","toTimeString","Router","defaults","require","apiConfig","Sale","props","token","state","loggedIn","user","sale","defaultSale","maxBid","amount","bidder","email","nameSurname","then","setState","id","response","push","owner","buyer","salePrice","padding","marginTop","boxShadow","maxHeight","overflow","productImageBase","images","title","endDate","_id","React","Component","getInitialProps","ctx","query"],"mappings":"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","sourcesContent":["import Layout from '../../components/AppLayout';\nimport ChatBox from \"../../components/ChatBox\";\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport {Badge} from \"reactstrap\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faLiraSign, faUser, faMoneyBill, faUsers, faThumbsUp, faCalendarAlt } from '@fortawesome/free-solid-svg-icons'\nimport Link from \"next/link\";\nimport {auth, getUser} from \"../../utils/auth\";\nimport {getSale} from \"../../utils/api\";\nimport {toTimeString} from \"../../utils/miscellaneous\";\nimport Router from 'next/router';\n\nconst defaults = require('../../utils/defaults');\nconst apiConfig = require('../../api-config');\n\nclass Sale extends React.Component{\n    constructor(props) {\n        super(props);\n        let token = this.props.token;\n        this.state = {\n            loggedIn: !!token,\n            user: {},\n            sale: defaults.defaultSale,\n            maxBid: {\n                amount: 0,\n                bidder: {\n                    email: \"\",\n                    nameSurname: \"\"\n                }\n            }\n        };\n    }\n    componentDidMount() {\n        getUser(this.props.token).then(user => {\n            this.setState({\n                user: user\n            });\n        });\n        getSale(this.props.id).then(response => {\n            if (!response){\n                Router.push('/sales');\n                return;\n            }\n            if(response.sale.owner.email !== this.state.user.email){\n                Router.push('/sales');\n            }\n            this.setState({\n                sale: response.sale,\n                maxBid: response.maxBid\n            });\n        });\n    }\n\n    render() {\n        const buyer = this.state.maxBid.bidder.nameSurname;\n        const salePrice = this.state.maxBid.amount;\n        return (\n            <Layout page=\"me\" user={this.state.user} loggedIn={this.state.loggedIn}>\n                <div className=\"container bg-white\"\n                     style={{ padding:'3%', marginTop:'3%', boxShadow: '0px 10px 5px 0px #ccc'}} >\n                    <div className=\"row\">\n                        <div className=\"col-md-1\"></div>\n                        <div className=\"col-md-5\">\n                            <div className=\"mb-3\" style={{maxHeight: '400px', overflow: 'hidden'}}>\n                                <img src={apiConfig.productImageBase + this.state.sale.images[0]} width=\"100%\" />\n                            </div>\n                            <h4>\n                                {this.state.sale.title}\n                                <Badge className=\"ml-3\" color=\"success\" pill>\n                                    Aldınız\n                                </Badge>\n                            </h4>\n                            <hr/>\n                            <div className=\"row mt-4\">\n\n                                <p className=\"col-md-6 \">\n                                    <FontAwesomeIcon icon={faUser} width=\"16\" /> <b>Alıcı: </b> {buyer}\n                                </p>\n                                <p className=\"col-md-6 \">\n                                    <FontAwesomeIcon icon={faMoneyBill} width=\"16\" /> <b>Satış Fiyatı: </b> {salePrice}₺\n                                </p>\n                                <p className=\"col-md-12 mb-4\">\n                                    <FontAwesomeIcon icon={faCalendarAlt} width=\"16\" /> <b>Kapanış Tarihi: </b>\n                                    {toTimeString(this.state.sale.endDate)}\n                                </p>\n                            </div>\n                        </div>\n                        <div className=\"col-md-1\"></div>\n                        <div className=\"col-md-5\">\n                            <ChatBox interlocutor={buyer}\n                                     saleId={this.state.sale._id}\n                                     salePrice={salePrice}\n                                     userToken={this.props.token}\n                                     userEmail={this.state.user.email}\n                                     receiverEmail={this.state.maxBid.bidder.email} />\n                        </div>\n                    </div>\n                </div>\n            </Layout>\n        );\n    }\n}\n\nSale.getInitialProps = async ctx => {\n    const {id} = ctx.query;\n\n    // Check user's session\n    const token = auth(ctx);\n\n    return { id, token }\n};\n\nexport default Sale;"]},"metadata":{},"sourceType":"module"}