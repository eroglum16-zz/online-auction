{"ast":null,"code":"import _Date$now from \"@babel/runtime-corejs2/core-js/date/now\";\nimport Router from 'next/router';\nimport nextCookie from 'next-cookies';\nimport cookie from '../node_modules/js-cookie';\nexport var login = function login(_ref) {\n  var token = _ref.token;\n  cookie.set('token', token, {\n    expires: 1\n  });\n  Router.push('/index');\n};\nexport var auth = function auth(ctx) {\n  var _nextCookie = nextCookie(ctx),\n      token = _nextCookie.token;\n\n  if (ctx.req && !token) {\n    ctx.res.writeHead(302, {\n      Location: '/login'\n    });\n    ctx.res.end();\n    return;\n  }\n\n  if (!token) {\n    Router.push('/login');\n  }\n\n  return token;\n};\nexport var guest = function guest(ctx) {\n  var _nextCookie2 = nextCookie(ctx),\n      token = _nextCookie2.token;\n\n  if (ctx.req && token) {\n    ctx.res.writeHead(302, {\n      Location: '/index'\n    });\n    ctx.res.end();\n    return;\n  }\n\n  if (token) {\n    Router.push('/index');\n  }\n\n  return;\n};\nexport var getToken = function getToken(ctx) {\n  var _nextCookie3 = nextCookie(ctx),\n      token = _nextCookie3.token;\n\n  return token;\n};\nexport var logout = function logout() {\n  cookie.remove('token'); // to support logging out from all windows\n\n  window.localStorage.setItem('logout', _Date$now());\n  Router.push('/login');\n};","map":{"version":3,"sources":["/Users/mert/Desktop/İTÜ/Fall 2019/Bitirme/Project/utils/auth.js"],"names":["Router","nextCookie","cookie","login","token","set","expires","push","auth","ctx","req","res","writeHead","Location","end","guest","getToken","logout","remove","window","localStorage","setItem"],"mappings":";AAAA,OAAOA,MAAP,MAAmB,aAAnB;AACA,OAAOC,UAAP,MAAuB,cAAvB;AACA,OAAOC,MAAP,MAAmB,2BAAnB;AAEA,OAAO,IAAMC,KAAK,GAAG,SAARA,KAAQ,OAAe;AAAA,MAAZC,KAAY,QAAZA,KAAY;AAChCF,EAAAA,MAAM,CAACG,GAAP,CAAW,OAAX,EAAoBD,KAApB,EAA2B;AAAEE,IAAAA,OAAO,EAAE;AAAX,GAA3B;AACAN,EAAAA,MAAM,CAACO,IAAP,CAAY,QAAZ;AACH,CAHM;AAKP,OAAO,IAAMC,IAAI,GAAG,SAAPA,IAAO,CAAAC,GAAG,EAAI;AAAA,oBACLR,UAAU,CAACQ,GAAD,CADL;AAAA,MACfL,KADe,eACfA,KADe;;AAGvB,MAAIK,GAAG,CAACC,GAAJ,IAAW,CAACN,KAAhB,EAAuB;AACnBK,IAAAA,GAAG,CAACE,GAAJ,CAAQC,SAAR,CAAkB,GAAlB,EAAuB;AAAEC,MAAAA,QAAQ,EAAE;AAAZ,KAAvB;AACAJ,IAAAA,GAAG,CAACE,GAAJ,CAAQG,GAAR;AACA;AACH;;AAED,MAAI,CAACV,KAAL,EAAY;AACRJ,IAAAA,MAAM,CAACO,IAAP,CAAY,QAAZ;AACH;;AAED,SAAOH,KAAP;AACH,CAdM;AAgBP,OAAO,IAAMW,KAAK,GAAG,SAARA,KAAQ,CAAAN,GAAG,EAAI;AAAA,qBACNR,UAAU,CAACQ,GAAD,CADJ;AAAA,MAChBL,KADgB,gBAChBA,KADgB;;AAGxB,MAAIK,GAAG,CAACC,GAAJ,IAAWN,KAAf,EAAsB;AAClBK,IAAAA,GAAG,CAACE,GAAJ,CAAQC,SAAR,CAAkB,GAAlB,EAAuB;AAAEC,MAAAA,QAAQ,EAAE;AAAZ,KAAvB;AACAJ,IAAAA,GAAG,CAACE,GAAJ,CAAQG,GAAR;AACA;AACH;;AAED,MAAIV,KAAJ,EAAW;AACPJ,IAAAA,MAAM,CAACO,IAAP,CAAY,QAAZ;AACH;;AAED;AACH,CAdM;AAgBP,OAAO,IAAMS,QAAQ,GAAG,SAAXA,QAAW,CAAAP,GAAG,EAAI;AAAA,qBACTR,UAAU,CAACQ,GAAD,CADD;AAAA,MACnBL,KADmB,gBACnBA,KADmB;;AAG3B,SAAOA,KAAP;AACH,CAJM;AAMP,OAAO,IAAMa,MAAM,GAAG,SAATA,MAAS,GAAM;AACxBf,EAAAA,MAAM,CAACgB,MAAP,CAAc,OAAd,EADwB,CAExB;;AACAC,EAAAA,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,QAA5B,EAAsC,WAAtC;AACArB,EAAAA,MAAM,CAACO,IAAP,CAAY,QAAZ;AACH,CALM","sourcesContent":["import Router from 'next/router'\nimport nextCookie from 'next-cookies'\nimport cookie from '../node_modules/js-cookie'\n\nexport const login = ({ token }) => {\n    cookie.set('token', token, { expires: 1 })\n    Router.push('/index')\n}\n\nexport const auth = ctx => {\n    const { token } = nextCookie(ctx);\n\n    if (ctx.req && !token) {\n        ctx.res.writeHead(302, { Location: '/login' });\n        ctx.res.end();\n        return\n    }\n\n    if (!token) {\n        Router.push('/login')\n    }\n\n    return token\n};\n\nexport const guest = ctx => {\n    const { token } = nextCookie(ctx);\n\n    if (ctx.req && token) {\n        ctx.res.writeHead(302, { Location: '/index' });\n        ctx.res.end();\n        return\n    }\n\n    if (token) {\n        Router.push('/index')\n    }\n\n    return;\n};\n\nexport const getToken = ctx => {\n    const { token } = nextCookie(ctx);\n\n    return token\n};\n\nexport const logout = () => {\n    cookie.remove('token')\n    // to support logging out from all windows\n    window.localStorage.setItem('logout', Date.now())\n    Router.push('/login')\n}"]},"metadata":{},"sourceType":"module"}