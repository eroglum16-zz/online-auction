{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/mert/Desktop/I\\u0307TU\\u0308/Fall 2019/Bitirme/Project/pages/index.js\";\nvar __jsx = React.createElement;\nimport Layout from \"../components/AppLayout\";\nimport \"../node_modules/bootstrap/dist/css/bootstrap.min.css\";\nimport ItemCard from \"../components/ItemCard\";\nimport { getToken, guest } from '../utils/auth';\nimport { Alert } from 'reactstrap';\nimport axios from \"axios\";\nimport socketIOClient from 'socket.io-client';\nimport React from \"react\";\n\nvar apiConfig = require('../api-config');\n\nvar socket = socketIOClient(apiConfig.serverUrl);\n\nvar Index =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Index, _React$Component);\n\n  function Index(props) {\n    var _this;\n\n    _classCallCheck(this, Index);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Index).call(this, props));\n    var token = _this.props.token;\n\n    _this.getUser(token);\n\n    _this.getActiveSales();\n\n    _this.state = {\n      loggedIn: !!token,\n      user: {\n        nameSurname: \"\"\n      },\n      sales: [],\n      serverDown: false\n    };\n    return _this;\n  }\n\n  _createClass(Index, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      socket.on('update sales', function () {\n        _this2.getActiveSales();\n      });\n    }\n  }, {\n    key: \"getUser\",\n    value: function getUser(token) {\n      var _this3 = this;\n\n      var url = apiConfig.serverUrl + '/user/get';\n      axios.post(url, {}, {\n        headers: {\n          authorization: token\n        }\n      }).then(function (response) {\n        _this3.setState({\n          user: response.data.user\n        });\n      })[\"catch\"](function (error) {\n        if (token) this.setState({\n          serverDown: true\n        });\n        console.log(error);\n      }.bind(this));\n    }\n  }, {\n    key: \"getActiveSales\",\n    value: function getActiveSales() {\n      var _this4 = this;\n\n      var url = apiConfig.serverUrl + '/sales';\n      axios.get(url).then(function (response) {\n        _this4.setState({\n          sales: response.data.sales\n        });\n      })[\"catch\"](function (error) {\n        console.log(error);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var sales = this.state.sales.map(function (sale) {\n        return __jsx(ItemCard, {\n          sale: sale,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 64\n          },\n          __self: this\n        });\n      });\n      return __jsx(Layout, {\n        page: \"home\",\n        user: this.state.user,\n        loggedIn: this.state.loggedIn,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        className: \"container bg-white\",\n        style: {\n          padding: '3%',\n          marginTop: '3%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68\n        },\n        __self: this\n      }, __jsx(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      }, \" Online A\\xE7\\u0131k Artt\\u0131rma Uygulamas\\u0131\"), __jsx(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      }), this.state.serverDown ? __jsx(Alert, {\n        style: {\n          fontFamily: 'verdana',\n          fontSize: '17px'\n        },\n        color: \"primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73\n        },\n        __self: this\n      }, \"Sunucular\\u0131m\\u0131zdaki sorundan dolay\\u0131 hizmet veremiyoruz. \\xC7ok yak\\u0131nda geri d\\xF6nece\\u011Fiz. Anlay\\u0131\\u015F\\u0131n\\u0131z i\\xE7in te\\u015Fekk\\xFCr ederiz.\") : __jsx(\"p\", {\n        style: {\n          fontFamily: 'verdana',\n          fontSize: '17px',\n          marginBottom: '50px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78\n        },\n        __self: this\n      }, \"\\xDCr\\xFCnlerinizi platformumuzda a\\xE7\\u0131k artt\\u0131rmaya sunabilir, veya aktif a\\xE7\\u0131k artt\\u0131rmalara kat\\u0131larak de\\u011Ferli \\xFCr\\xFCnleri alma f\\u0131rsat\\u0131 yakalayabilirsiniz. A\\u015Fa\\u011F\\u0131daki \\xFCr\\xFCnlerden ilginizi \\xE7ekeni se\\xE7erek sat\\u0131\\u015Fa giderseniz teklifte bulunabilirsiniz.\"), __jsx(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      }), __jsx(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      }, sales)));\n    }\n  }]);\n\n  return Index;\n}(React.Component);\n\nIndex.getInitialProps =\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(ctx) {\n    var token;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            // Check user's session\n            token = getToken(ctx);\n            return _context.abrupt(\"return\", {\n              token: token\n            });\n\n          case 2:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nexport default Index;","map":{"version":3,"sources":["/Users/mert/Desktop/İTÜ/Fall 2019/Bitirme/Project/pages/index.js"],"names":["Layout","ItemCard","getToken","guest","Alert","axios","socketIOClient","React","apiConfig","require","socket","serverUrl","Index","props","token","getUser","getActiveSales","state","loggedIn","user","nameSurname","sales","serverDown","on","url","post","headers","authorization","then","response","setState","data","error","console","log","bind","get","map","sale","padding","marginTop","fontFamily","fontSize","marginBottom","Component","getInitialProps","ctx"],"mappings":"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","sourcesContent":["import Layout from \"../components/AppLayout\";\nimport \"../node_modules/bootstrap/dist/css/bootstrap.min.css\";\nimport ItemCard from \"../components/ItemCard\";\nimport { getToken, guest } from '../utils/auth'\nimport { Alert } from 'reactstrap';\nimport axios from \"axios\";\nimport socketIOClient from 'socket.io-client';\nimport React from \"react\";\n\nconst apiConfig = require('../api-config');\nconst socket = socketIOClient(apiConfig.serverUrl);\n\nclass Index extends React.Component{\n    constructor(props) {\n        super(props);\n        var token = this.props.token;\n        this.getUser(token);\n        this.getActiveSales();\n        this.state = {\n            loggedIn: !!token,\n            user: {\n                nameSurname: \"\"\n            },\n            sales: [],\n            serverDown: false\n        }\n    }\n    componentDidMount() {\n        socket.on('update sales', () => {\n            this.getActiveSales();\n        });\n    }\n    getUser(token){\n        const url = apiConfig.serverUrl + '/user/get';\n        axios.post(url, {}, {\n            headers:{\n                authorization: token\n            }})\n            .then((response) => {\n                this.setState({\n                    user: response.data.user\n                });\n            })\n            .catch(function (error) {\n                if(token) this.setState({\n                    serverDown: true\n                });\n                console.log(error);\n            }.bind(this));\n    }\n    getActiveSales(){\n        const url = apiConfig.serverUrl + '/sales';\n        axios.get(url)\n            .then((response) => {\n                this.setState({\n                    sales: response.data.sales\n                });\n            }).catch((error) => {\n                console.log(error);\n            });\n    }\n    render() {\n        const sales = this.state.sales.map((sale) =>\n            <ItemCard sale={sale} />\n                      );\n        return (\n            <Layout page=\"home\" user={this.state.user} loggedIn={this.state.loggedIn}>\n                <div className=\"container bg-white\" style={{ padding:'3%', marginTop:'3%'}}>\n                    <h2> Online Açık Arttırma Uygulaması</h2>\n                    <hr/>\n                    {\n                        this.state.serverDown ?\n                            <Alert style={{fontFamily:'verdana', fontSize:'17px'}} color=\"primary\">\n                                Sunucularımızdaki sorundan dolayı hizmet veremiyoruz. Çok yakında geri döneceğiz.\n                                Anlayışınız için teşekkür ederiz.\n                            </Alert>\n                            :\n                            <p style={{fontFamily:'verdana', fontSize:'17px', marginBottom:'50px'}}>\n                                Ürünlerinizi platformumuzda açık arttırmaya sunabilir, veya aktif açık arttırmalara\n                                katılarak değerli ürünleri alma fırsatı yakalayabilirsiniz. Aşağıdaki ürünlerden ilginizi çekeni seçerek\n                                satışa giderseniz teklifte bulunabilirsiniz.\n                            </p>\n                    }\n\n                    <hr></hr>\n                    <div className=\"row\">\n                        {sales}\n                    </div>\n                </div>\n            </Layout>\n        );\n    }\n}\n\nIndex.getInitialProps = async ctx => {\n    // Check user's session\n    const token = getToken(ctx);\n\n    return { token }\n};\n\nexport default Index;"]},"metadata":{},"sourceType":"module"}